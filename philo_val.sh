#!/bin/bash

# ============================================================
# Philosopher Valgrind Tester
# Runs Valgrind on all input validation cases, one by one
# ============================================================

VALGRIND="valgrind --leak-check=full --show-leak-kinds=all --error-exitcode=42"
PHILO="./philo"

# Check if executable exists
if [ ! -x "$PHILO" ]; then
    echo "Error: $PHILO not found or not executable."
    exit 1
fi

# Define all test cases
TESTS=(
"0 0 0 0"
"0 0 0 1"
"0 0 1 0"
"0 0 1 1"
"0 1 0 0"
"0 1 0 1"
"0 1 1 0"
"0 1 1 1"
"1 0 0 0"
"1 0 0 1"
"1 0 1 0"
"1 0 1 1"
"1 1 0 0"
"1 1 0 1"
"1 1 1 0"
"1 1 1 1"
"2 0 0 0"
"2 0 0 1"
"2 0 1 0"
"2 0 1 1"
"2 1 0 0"
"2 1 0 1"
"2 1 1 0"
"2 1 1 1"
"-2 410 200 200"
"2 -410 200 200"
"2 410 -200 200"
"2 410 200 -200"
"+-2 410 200 200"
"2 +-410 200 200"
"2 410 +-200 200"
"2 410 200 +-200"
"-+2 410 200 200"
"2 -+410 200 200"
"2 410 -+200 200"
"2 410 200 -+200"
"-000+002 +00410 0+200 0-200"
"00+2 0-0410 200 200"
"+0-2 -0+410 +0-200 -0+200"
"0+02 0410 -0200 +0200"
"2 +410 00-200 0+200"
"-+2 +-410 +00200 -00200"
"+02 0+0410 +0-200 -0+200"
"00+2 -00410 +0200 -0200"
"a2 410 200 200"
"2a 410 200 200"
"2 a410 200 200"
"2 410a 200 200"
"2 410 a200 200"
"2 410 200a 200"
"2 410 200 a200"
"2 410 200 200a"
"000002 410 200 200"
"2 00000410 200 200"
"2 410 000000200 200"
"2 410 200 00000000000200"
"02 00410 200 200"
"02 00410 00200 000200"
"000002 0410 200 00000200"
"2 0000410 200 00000200"
"+2 410 200 200"
"2 +410 200 200"
"2 410 +200 200"
"2 410 200 +200"
"++2 410 200 200"
"2 ++410 200 200"
"2 410 ++200 200"
"2 410 200 ++200"
"2"
"2 410"
"2 410 200"
"2 410 200 200 200"
"0 0 0 0 0"
"0 0 0 0 1"
"0 0 0 1 0"
"0 0 0 1 1"
"0 0 1 0 0"
"0 0 1 0 1"
"0 0 1 1 0"
"0 0 1 1 1"
"0 1 0 0 0"
"0 1 0 0 1"
"0 1 0 1 0"
"0 1 0 1 1"
"0 1 1 0 0"
"0 1 1 0 1"
"0 1 1 1 0"
"0 1 1 1 1"
"1 0 0 0 0"
"1 0 0 0 1"
"1 0 0 1 0"
"1 0 0 1 1"
"1 0 1 0 0"
"1 0 1 0 1"
"1 0 1 1 0"
"1 0 1 1 1"
"1 1 0 0 0"
"1 1 0 0 1"
"1 1 0 1 0"
"1 1 0 1 1"
"1 1 1 0 0"
"1 1 1 0 1"
"1 1 1 1 0"
"1 1 1 1 1"
"2 0 0 0 0"
"2 0 0 0 1"
"2 0 0 1 0"
"2 0 0 1 1"
"2 0 1 0 0"
"2 0 1 0 1"
"2 0 1 1 0"
"2 0 1 1 1"
"2 1 0 0 0"
"2 1 0 0 1"
"2 1 0 1 0"
"2 1 0 1 1"
"2 1 1 0 0"
"2 1 1 0 1"
"2 1 1 1 0"
"2 1 1 1 1"
"a2 410 200 200 1"
"2a 410 200 200 1"
"2 a410 200 200 1"
"2 410a 200 200 1"
"2 410 a200 200 1"
"2 410 200a 200 1"
"2 410 200 a200 1"
"2 410 200 200a 1"
"2 410 200 200 a1"
"2 410 200 200 1a"
"000002 410 200 200 1"
"2 00000410 200 200 1"
"2 410 000000200 200 1"
"2 410 200 000000200 1"
"02 00410 200 200 1"
"02 00410 00200 000200 1"
"000002 0410 200 00000200 1"
"2 0000410 200 00000200 1"
"2 410 200 200 000000200"
"+2 410 200 200 1"
"2 +410 200 200 1"
"2 410 +200 200 1"
"2 410 200 +200 1"
"2 410 200 200 +1"
"-2 410 200 200 1"
"2 -410 200 200 1"
"2 410 -200 200 1"
"2 410 200 -200 1"
"2 410 200 200 -1"
"+-2 410 200 200 1"
"2 +-410 200 200 1"
"2 410 +-200 200 1"
"2 410 200 +-200 1"
"-+2 410 200 200 1"
"2 -+410 200 200 1"
"2 410 -+200 200 1"
"2 410 200 -+200 1"
"2 410 200 200 +-1"
"-000+002 +00410 0+200 0-200 1"
"00+2 0-0410 200 200 1"
"+0-2 -0+410 +0-200 -0+200 1"
"0+02 0410 -0200 +0200 1"
"2 +410 00-200 0+200 1"
"-+2 +-410 +00200 -00200 1"
"+02 0+0410 +0-200 -0+200 1"
"00+2 -00410 +0200 -0200 1"
"-000+002 +00410 0+200 0-200 0"
"00+2 0-0410 200 200 0"
"+0-2 -0+410 +0-200 -0+200 0"
"0+02 0410 -0200 +0200 0"
"2 +410 00-200 0+200 0"
"-+2 +-410 +00200 -00200 0"
"+02 0+0410 +0-200 -0+200 0"
"00+2 -00410 +0200 -0200 0"
"2 410 200 200 a"
"2 410 200 200 +"
"2 410 200 200 -"
"2 410 200 200 +-"
"2 410 200 200 000001"
"2 410 200 200 -000001"
"2 410 200 200 +000001"
)

# ============================================================
# Run Valgrind for each test
# ============================================================

counter=1
total=${#TESTS[@]}

for args in "${TESTS[@]}"; do
    echo
    echo "============================================================"
    echo "[$counter/$total] Running: $PHILO $args"
    echo "============================================================"
    $VALGRIND $PHILO $args
    echo "------------------------------------------------------------"
    echo
    ((counter++))
done

echo "âœ… All $total tests finished!"
